<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title></title>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    <link href="./css/style.css" rel="stylesheet">

    <script>
        var displayOptions = {
            date: "latest", //latest(default), oldest
            type: "All", //Any(default), Full-Time, Part-Time
            };


        var jobs = [{
            locationName: "Some cafe", //Name of the restaurant
            locationType: "Cafe", //Whether Restaurant, Fast-food, Cafe,
            position: "Bartender", //Name of the open position
            type: "Full-Time", //Either Full-Time or Part-Time
            address: "Howitzvej", //Street name
            civic: "60", //Civic number
            city: "Frederiksberg",
            zip: "2000",
            creationDate: "Fri Mar 01 2019 16:21:12 GMT+0100", //Javascript Date object. It is the date the job announcement has been posted
            startingDate: "Mon Apr 01 2019 20:30:12 GMT+0100", //Javascript Date object. It is the date of job start
            image: "", //Optional, url image for the modal
            fullDescription: "This is a test. This box... ", // Optional, longer description for the modal
        },
        {
            locationName: "Some Restaurant", //Name of the restaurant
            locationType: "Restaurant", //Whether Restaurant, Fast-food, Cafe,
            position: "Cook", //Name of the open position
            type: "Part-Time", //Either Full-Time or Part-Time
            address: "Howitzvej", //Street name
            civic: "602", //Civic number
            city: "Frederiksberg2",
            zip: "2000",
            creationDate: "Fri Mar 01 2019 10:21:12 GMT+0100", //Javascript Date object. It is the date the job announcement has been posted
            startingDate: "Tue Apr 02 2019 20:30:12 GMT+0100", //Javascript Date object. It is the date of job start
            image: "", //Optional, url image for the modal
            fullDescription: "This is a test. This box... ", // Optional, longer description for the modal
        },
            
        {
            locationName: "Some Fast-Food", //Name of the restaurant
            locationType: "Fast-Food", //Whether Restaurant, Fast-food, Cafe,
            position: "Cook", //Name of the open position
            type: "Part-Time", //Either Full-Time or Part-Time
            address: "Fasanvej", //Street name
            civic: "1", //Civic number
            city: "Frederiksberg",
            zip: "2000",
            creationDate: "Thu Mar 14 2019 10:21:12 GMT+0100", //Javascript Date object. It is the date the job announcement has been posted
            startingDate: "0", //Javascript Date object. It is the date of job start
            image: "", //Optional, url image for the modal
            fullDescription: "This is a test. This box... ", // Optional, longer description for the modal
        }];

        function populateJobsList() {
            jobs.forEach(function (dbJob) {
                console.log(displayOptions.type + " " + dbJob.type);

                if (displayOptions.type == 'All') { 
                    console.log("Display selction is:" + displayOptions.type);
                    appendToJobListing(dbJob);
                }
                else if (displayOptions.type == dbJob.type) {
                    console.log("Display selction is:" + displayOptions.type + "and listed job type is: " + dbJob.type)
                    appendToJobListing(dbJob);
                }
            });
        }

        function appendToJobListing(jobToAppend) {
            var dateDisplayptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            announcementDate = new Date(jobToAppend.creationDate).toLocaleDateString("en-US", dateDisplayptions);

            var startingDate = new Date(jobToAppend.startingDate);
            var now = new Date();

            if (startingDate.getTime() < now.getTime()) {
                startingDate = 'As soon as possible';
            }
            else {
                startingDate = startingDate.toLocaleDateString("en-US", dateDisplayptions);
            }
            
            htmlJob = `<div class="job-listing-wrapper" data-job-type="${jobToAppend.type}">` +
                `<h2 class="job-listing-header" >${jobToAppend.locationName}</h2 >` +
                `<p class="job-listing-info">${jobToAppend.position}, ${jobToAppend.type}.</p>` +
                `<p class="job-listing-date">Posted on: ${announcementDate}.</p>` +
                `<p class="job-listing-start" >Job start: ${startingDate}.</p >` +
                `</div >`;
            document.getElementById("job-list-container").insertAdjacentHTML('afterbegin', htmlJob);
        }

        function clearJobList() {
            document.getElementById('job-list-container').innerHTML = "";
        }

        function sortJobsAsc() {
            document.getElementById('active-sorting-date').innerHTML = 'Oldest first';
            jobs.sort(function (a, b) {
                // Turn your strings into dates, and then subtract them
                // to get a value that is either negative, positive, or zero.
                return new Date(b.creationDate) - new Date(a.creationDate);
            });
            console.log(jobs);
            clearJobList();
            populateJobsList();
        }

        function sortJobsDesc() {
            document.getElementById('active-sorting-date').innerHTML = 'Latest first';
            jobs.sort(function (a, b) {
                // Turn your strings into dates, and then subtract them
                // to get a value that is either negative, positive, or zero.
                return new Date(a.creationDate) - new Date(b.creationDate);
            });
            console.log(jobs);
            clearJobList();
            populateJobsList();
        }

        function hideJobs() {
            document.getElementById('job-list-container').innerHTML = '';
        }

        
        function showFullTimeOnly() {
            document.getElementById('active-sorting-job-type').innerHTML = 'Full-Time';
            hideJobs();

            displayOptions.type = 'Full-Time';
            populateJobsList();
        }


        function showPartTimeOnly() {
            document.getElementById('active-sorting-job-type').innerHTML = 'Part-Time';
            hideJobs();
            displayOptions.type = 'Part-Time';
            populateJobsList();
        }

        function showAnyJobType() {
            document.getElementById('active-sorting-job-type').innerHTML = 'All';
            hideJobs();
            displayOptions.type = 'All';
            populateJobsList();
        }

        document.addEventListener('DOMContentLoaded', function () {
            //alert("Page has been loaded");
            sortJobsDesc();

        });


    </script>

</head>


<body>
    <div class="header">
        <div class="nav-bar-wrapper">
            <ul class="nav-bar nav-left">
                <li class="nav-bar-item">
                    <a href="home.html">Home</a>
                </li>
                <li class="nav-bar-item">
                    <a href="">My workplaces</a>
                </li>
                <li class="nav-bar-item">
                    <a href="">My restaurants</a>
                </li>
                <li class="nav-bar-item active">
                    <a href="">Jobs</a>
                </li>
                <li class="nav-bar-item">
                    <a href="">Notifications</a>
                </li>

            </ul>
            <ul class="nav-bar nav-right">
                <li class="nav-bar-item" id="profile-nav">
                    <a href="">Profile</a>
                </li>
                <li class="nav-bar-item" id="login-nav">
                    <a href="login.html">Login</a>
                </li>
            </ul>
        </div>
        <div class="header-wall"><!--<img src="./resources/images/header.jpg" style="width:100%;"/>--></div>
    </div>

    <div class="main">
        <div class="jobs-filter-bar">
            <!-- Date dropdown filter-->
            <div class="option-selector" id="date-option-selector">
                <span class="option-label" id="sort-by-date"><span id="active-sorting-date">Latest first</span><span class="option-label-dropdown"></span></span>
                <ul class="suboption-list" id="suboption-date">
                    <li onclick="sortJobsDesc();">Latest first</li>
                    <li onclick="sortJobsAsc();">Oldest first</li>
                </ul>
            </div>
            <!-- End of date dropdown filter-->
            <!-- Job type dropdown filter-->
            <div class="option-selector" id="type-option-selector">
                <span class="option-label" id="sort-by-type"><span id="active-sorting-job-type">All</span><span class="option-label-dropdown"></span></span>
                <ul class="suboption-list" id="suboption-type">
                    <li onclick="showAnyJobType();">All</li>
                    <li onclick="showFullTimeOnly();">Full-Time</li>
                    <li onclick="showPartTimeOnly();">Part-Time</li>
                </ul>
            </div>
            <!-- End of job type dropdown filter-->
        </div>
        <div class="jobs-list" id="job-list-container">

        </div>
    </div>

    <div class="footer"></div>
</body>
</html>


